-- CS234 RL 2019
-- Data extraction for MIRT model and MAB
-- Total >2300 tests, >1000 items extracted 
-- Output CSV format: CALL, RESPONSE, ITEM, SCORE_VALUE

create table tmp_rldata_pron as
select distinct r.call, r.response, "c"||r.grp||r.ansitem item, m.value
from mgcalls mc, machgrades m, responses r
where mc.call = r.call
and r.response = m.response
and mc.SWREVISION = 203
and m.MPARAM = 5051
order by r.call, r.response
;

create table tmp_rldata_pron_pivot as 
select * 
from 
  (select call, item, value from tmp_rldata_pron)
pivot (
  avg(value) 
  for item
  in (1001101,1001102,1001103,1001104,1001105,1001107,1001108,1001109,100111,1001110,1001111,1001112,1001113,1001114,1001118,1001119,100112,1001120,1001121,1001123,1001129,100113,1001130,1001131,1001132,1001133,1001134,1001135,1001136,1001139,100114,1001140,1001141,1001142,1001143,1001145,1001146,1001147,1001148,100115,1001150,1001151,1001152,1001153,1001154,1001155,1001157,1001158,1001159,100116,1001160,1001161,1001162,1001165,1001166,1001167,1001168,100117,1001170,1001171,1001174,1001176,1001177,100118,1001181,1001182,1001183,1001184,1001185,1001187,1001188,1001189,100119,1001190,1001191,1001192,1001193,1001195,1001197,1001199,10012,100120,1001200,1001201,1001204,1001205,1001209,100121,1001210,1001211,1001213,1001214,1001216,1001217,100122,1001220,1001222,1001224,1001225,1001227,1001228,1001229,100123,1001230,1001231,1001232,1001233,1001235,1001237,1001238,100124,1001241,1001243,1001245,1001246,1001247,1001249,100125,1001251,1001252,1001253,1001255,1001256,1001258,100126,1001261,1001263,1001264,1001265,1001268,100127,1001270,1001273,1001274,1001275,1001277,1001278,100128,1001280,1001281,1001282,1001283,1001285,100129,1001290,1001291,1001293,1001295,1001296,1001297,1001298,10013,100130,1001301,1001306,1001307,1001309,100131,1001311,1001313,1001316,1001317,1001318,1001319,1001320,1001321,1001322,1001323,1001324,1001325,1001326,1001327,1001328,1001329,100133,1001330,1001331,1001332,1001334,1001335,1001336,1001337,1001338,1001339,100134,1001340,1001341,1001343,1001344,1001345,1001346,1001348,1001349,100135,1001350,1001351,1001352,1001353,1001354,1001355,1001357,1001358,1001359,100136,1001360,1001361,1001362,1001363,1001364,1001365,1001366,1001368,1001369,100137,1001370,1001371,1001372,1001373,1001374,1001375,1001376,1001377,1001378,1001379,100138,1001381,1001382,1001383,1001384,1001386,1001387,1001388,1001389,100139,1001391,1001392,1001393,1001396,10014,1001407,1001409,1001410,1001419,100142,1001420,1001422,1001425,1001426,1001427,100143,1001438,1001439,100144,1001440,1001441,1001442,1001443,1001444,1001445,1001446,1001447,1001448,1001449,1001450,1001451,1001452,1001453,1001454,1001455,1001456,1001457,1001458,1001459,100146,1001460,1001461,1001462,1001463,100148,100149,10015,100151,100152,100153,100154,100156,100157,100158,100159,10016,100160,100161,100162,100166,100167,100168,100169,10017,100170,100171,100172,100173,100174,100175,100176,100177,100178,100179,10018,100180,100181,100182,100183,100184,100185,100186,100188,100189,10019,100191,100192,100193,100194,100195,100197,100198,100199,1002100,1002101,1002102,1002103,1002104,1002105,1002106,1002107,1002108,1002109,100211,1002110,1002111,1002112,1002113,1002114,1002115,1002116,1002118,1002119,1002120,1002121,1002122,1002123,1002124,1002125,1002126,1002127,1002128,1002129,100213,1002130,1002131,1002132,1002133,1002134,1002136,1002137,1002138,1002139,1002140,1002141,1002143,1002145,1002146,1002147,1002148,1002149,1002150,1002151,1002152,1002153,1002154,1002155,1002156,1002159,100216,1002160,1002161,1002162,1002164,1002165,1002166,1002167,1002168,1002169,100217,1002170,1002171,1002172,1002173,1002175,1002176,1002177,1002178,100218,1002180,1002181,1002182,1002183,1002184,1002185,1002186,1002187,1002188,1002189,100219,1002190,1002194,1002195,1002196,1002197,1002198,1002199,10022,100220,1002200,1002201,1002202,1002203,1002204,1002205,1002206,1002207,1002208,1002209,100221,1002210,1002211,1002212,1002213,1002214,1002215,1002216,1002217,1002219,100222,1002220,1002221,1002222,1002223,1002224,1002225,1002226,1002227,1002228,1002229,100223,1002230,1002231,1002232,1002233,1002234,1002235,1002236,1002237,1002238,1002239,100224,1002240,1002241,1002242,1002243,1002244,1002245,1002246,1002247,1002248,1002249,100225,1002250,1002251,1002252,1002253,1002254,1002255,1002256,1002257,1002258,1002259,100226,1002260,1002261,1002262,1002263,1002264,1002265,1002266,1002267,1002268,1002269,100227,1002270,1002271,1002272,1002273,1002274,1002275,1002276,1002277,1002278,1002279,100228,1002280,1002281,1002282,1002283,1002284,1002285,1002286,1002287,1002288,1002289,100229,1002290,1002291,1002292,1002293,1002294,1002295,1002296,1002297,1002298,1002299,10023,100230,1002300,1002301,1002302,1002303,1002304,1002305,1002306,1002307,1002309,100231,1002310,1002311,1002313,1002314,1002316,1002317,1002318,1002319,100232,1002320,1002321,1002322,1002323,1002324,1002325,1002326,1002327,1002328,1002329,100233,1002330,1002331,1002332,1002333,1002334,1002335,1002336,1002337,1002338,1002339,100234,1002340,1002341,1002342,1002343,1002344,1002345,1002346,1002347,1002348,1002349,100235,1002350,1002351,1002352,1002353,1002355,1002356,1002357,1002358,1002359,100236,1002361,1002362,1002363,1002364,1002365,1002366,1002367,1002368,1002369,100237,1002370,1002371,1002372,1002373,1002374,1002376,1002377,1002378,1002379,100238,1002380,1002381,1002382,1002383,1002384,1002385,1002386,1002387,1002388,1002389,100239,1002390,1002391,1002392,1002393,1002394,1002395,1002396,1002397,1002398,1002399,10024,100240,1002400,1002401,1002402,1002403,1002404,1002405,1002406,1002408,1002409,100241,100242,100243,1002430,1002431,1002432,1002433,1002434,1002435,1002436,1002437,100244,1002440,1002441,1002443,1002446,100245,1002452,1002455,1002457,1002458,1002459,100246,1002462,1002464,1002466,1002467,1002468,100247,1002470,1002471,1002473,1002474,1002475,1002476,1002477,1002478,1002479,100248,1002481,1002482,1002483,1002484,1002485,1002487,1002488,1002489,100249,1002490,1002491,1002492,1002494,1002495,1002496,1002497,1002498,100250,1002500,1002502,1002503,1002504,1002505,1002507,1002508,1002509,100251,1002510,1002511,1002512,1002513,1002514,1002516,100252,1002520,1002521,1002522,1002524,1002528,100253,1002531,1002532,1002533,1002534,1002536,1002537,1002539,100254,1002542,1002543,1002545,1002548,1002549,100255,1002550,1002551,1002552,1002553,1002554,1002555,1002557,1002558,1002559,100256,1002561,1002562,1002564,1002566,1002567,100257,1002571,1002572,1002574,1002575,1002576,100258,1002580,1002581,1002583,1002584,1002586,1002587,100259,1002591,1002592,1002593,1002594,1002595,1002596,1002597,1002598,1002599,10026,100260,1002600,1002601,1002602,1002604,1002605,1002606,1002607,1002608,1002609,100261,1002610,1002612,1002613,1002614,1002616,1002617,1002618,1002619,100262,1002620,1002621,1002623,1002626,1002627,1002629,100263,1002631,1002632,1002634,1002635,1002636,1002637,1002638,100264,1002641,1002643,1002644,1002645,1002646,1002648,100265,1002652,1002654,1002656,1002659,100266,1002661,1002662,1002663,1002665,1002667,1002669,100267,1002670,1002671,1002672,1002673,1002675,1002676,1002677,1002678,1002679,100268,1002680,1002681,1002682,1002683,1002684,1002685,1002686,1002687,1002688,1002689,1002690,1002691,1002692,1002693,1002694,1002695,1002696,1002697,1002698,1002699,10027,100270,1002700,1002701,1002702,1002703,1002704,1002705,1002706,1002707,1002708,1002709,100271,1002710,1002711,1002712,1002713,1002714,1002715,1002716,1002717,1002718,1002719,100272,1002720,1002721,1002722,1002723,1002724,1002725,1002726,1002727,1002728,1002729,100273,1002730,1002731,1002732,1002733,1002734,1002735,1002736,1002737,1002738,1002739,100274,1002740,1002741,1002742,1002743,1002744,1002745,1002746,1002747,1002748,1002749,1002750,1002751,1002752,1002753,1002754,1002755,1002756,1002757,1002762,1002763,1002764,1002767,100277,100278,1002781,1002782,100279,1002790,1002791,10028,100280,1002800,1002808,100281,1002813,1002819,100282,1002820,1002826,1002828,100283,100284,1002840,1002846,1002847,100285,100286,100287,100288,100289,10029,100290,100291,100292,100294,100296,100297,100298,100299,1003100,1003102,1003103,1003104,1003105,1003106,1003107,10031076,10031077,1003108,10031086,1003109,10031090,10031091,10031092,10031094,1003110,10031103,10031105,1003111,10031112,10031119,1003112,10031122,1003113)
)
;
